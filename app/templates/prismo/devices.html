{% extends "layout.html" %}
{% block content %}
<div class="container-fluid px-md-5">
  <div class="container-fluid px-md-5">
    <div class="row">
      <div class="card">
        <div class="card-header">Add new RFID Reader Device:</div>
        <div class="card-body">
          <div class="input-group mb-3">
            <button
              class="btn btn-primary"
              type="submit"
              onclick="addDevice(document.querySelector('#device-name').value, document.querySelector('#device-type').checked)">
              <i class="bi bi-database-add"></i> Add device
            </button>
            <input type="text" class="form-control" id="device-name" placeholder="Device Name" />
            <input type="checkbox" checked data-toggle="toggle" id="device-type"
                   data-onlabel="<i class='bi bi-tools'></i> Tool" data-offlabel="<i c  lass='bi bi-door-closed'></i> Door">
          </div>
        </div>
      </div>
    </div>
    <div class="py-3">
      <div class="accordion" id="devicesList"></div>
    </div>

    <div
      class="modal fade"
      id="flashDeviceModal"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="staticBackdropLabel"
      aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">Flash Reader Device</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <div
              class="progress"
              role="progressbar"
              aria-label="Flashing Progress"
              aria-valuenow="25"
              aria-valuemin="0"
              aria-valuemax="100">
              <div class="progress-bar progress-bar-striped" style="width: 0%"></div>
            </div>
            <div class="d-flex justify-content-between">
              <p class="d-inline-flex gap-1">
                <a
                  class="link-primary"
                  data-bs-toggle="collapse"
                  href="#collapseLog"
                  role="button"
                  aria-expanded="false"
                  aria-controls="collapseLog">
                  Show operation log
                </a>
              </p>
              <p id="statusText"></p>
            </div>
            <div class="collapse" id="collapseLog">
              <div class="card card-body" id="log-container">
                <style>
                  .card-body {
                    overflow: auto;
                    max-height: 30vh;
                  }
                </style>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="flashFirmware()">
              <i class="bi bi-download"></i> Start
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="static/js/devices.js"></script>
</div>
{% endblock %}
